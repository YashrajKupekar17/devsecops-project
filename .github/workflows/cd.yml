name: CD Pipeline

on:
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Setup kubectl
      uses: azure/setup-kubectl@v3

    - name: Validate Kubernetes Manifests
      run: kubectl apply --dry-run=client -f k8s/

    - name: Start Minikube
      uses: medyagh/setup-minikube@latest

    - name: Deploy to Kubernetes
      run: kubectl apply -f k8s/

    - name: Verify Deployment
      run: kubectl get pods
